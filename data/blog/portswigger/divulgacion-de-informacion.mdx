---
title: Divulgacion de informacion
date: '2024-05-10'
lastmod: '2023-08-05'
tags: ['Portswigger', 'Information Disclosure', 'Labs']
draft: false
summary: 'La divulgaci√≥n de informaci√≥n, tambi√©n conocida como fuga de informaci√≥n, ocurre cuando un sitio web revela de manera involuntaria informaci√≥n sensible a sus usuarios.'
images: ['/static/images/htb/ewpt']
---

<p align="center">
  ![Portada](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/Designer.png)
</p>

<TOCInline toc={props.toc} exclude="Introduccion" />

## ¬øQu√© es la divulgaci√≥n de informaci√≥n?

La divulgaci√≥n de informaci√≥n, tambi√©n conocida como fuga de informaci√≥n, ocurre cuando un sitio web revela de manera involuntaria informaci√≥n sensible a sus usuarios. Esto puede exponer datos a posibles atacantes, incluyendo:

- Datos sobre otros usuarios, como nombres de usuario o informaci√≥n financiera
- Datos comerciales o empresariales sensibles
- Detalles t√©cnicos sobre el sitio web y su infraestructura

## Ejemplos b√°sicos de divulgaci√≥n de informaci√≥n

- **Directorios ocultos**: Revelar nombres, estructura y contenidos de directorios ocultos a trav√©s de archivos `robots.txt` o listados de directorios.
- **Exposici√≥n de c√≥digo fuente**: Proveer acceso a archivos de c√≥digo fuente a trav√©s de copias de seguridad temporales.
- **Mensajes de error**: Mencionar expl√≠citamente nombres de tablas o columnas de bases de datos en los mensajes de error.
- **Informaci√≥n sensible**: Exponer innecesariamente informaci√≥n altamente sensible, como detalles de tarjetas de cr√©dito.
- **Secretos codificados**: Codificar en el c√≥digo fuente claves API, direcciones IP y credenciales de bases de datos.
- **Comportamiento de la aplicaci√≥n**: Indicar la existencia o ausencia de recursos o nombres de usuario a trav√©s de diferencias sutiles en el comportamiento de la aplicaci√≥n.

## C√≥mo encontrar y explotar vulnerabilidades de divulgaci√≥n de informaci√≥n

- **Fuzzing**: Enviar entradas aleatorias o inesperadas a la aplicaci√≥n para descubrir c√≥mo maneja diferentes tipos de datos.
- **Uso de Burp Scanner**: Herramienta automatizada para escanear vulnerabilidades, incluyendo divulgaci√≥n de informaci√≥n.
- **Uso de las herramientas de compromiso de Burp**: Herramientas dentro de Burp Suite que ayudan a identificar y explotar vulnerabilidades de divulgaci√≥n de informaci√≥n.
- **Ingenier√≠a de respuestas informativas**: Crear entradas que provoquen mensajes de error u otras respuestas que revelen informaci√≥n √∫til.

## Mensajes de error

El contenido de los mensajes de error puede ser particularmente revelador. Pueden indicar qu√© tipo de entrada o datos se esperan, ayudando a identificar par√°metros explotables.

### Laboratorio 1 - Divulgaci√≥n de informaci√≥n en mensajes de error

> Los mensajes de error detallados de este laboratorio revelan que est√° utilizando una versi√≥n vulnerable de un marco de terceros. Para resolver el laboratorio, obt√©n y env√≠a el n√∫mero de versi√≥n de este marco.

Cuando comienzas el laboratorio, ves una p√°gina de tienda web t√≠pica. Ve a "Ver detalles".
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l1/2024-05-09_23-19.png)

Prueba si se produce un error si cambias el ID del producto.
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l1/2.png)

¬°Y s√≠!
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l1/3.png)

## Datos de depuraci√≥n

Los sitios web a menudo generan mensajes de error y registros personalizados con fines de depuraci√≥n. Estos pueden revelar involuntariamente mucha informaci√≥n sobre el comportamiento de la aplicaci√≥n, como:

- **Variables de sesi√≥n**: Valores que pueden manipularse a trav√©s de la entrada del usuario.
- **Credenciales de back-end**: Nombres de host y credenciales para componentes de back-end.
- **Nombres de archivos y directorios**: Nombres espec√≠ficos de archivos y directorios en el servidor.
- **Claves de cifrado**: Claves utilizadas para cifrar datos transmitidos a trav√©s del cliente.

### Laboratorio 2 - Divulgaci√≥n de informaci√≥n en la p√°gina de depuraci√≥n

> Este laboratorio contiene una p√°gina de depuraci√≥n que divulga informaci√≥n sensible sobre la aplicaci√≥n. Para resolver el laboratorio, obt√©n y env√≠a la variable de entorno SECRET_KEY.

Cada vez que realices una prueba de penetraci√≥n en una aplicaci√≥n web, es indispensable leer el c√≥digo de la aplicaci√≥n para buscar comentarios.

![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l2/1.png)
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l2/2.png)

## P√°ginas de cuenta de usuario

Las p√°ginas de cuenta de usuario o perfil suelen contener informaci√≥n sensible. Algunos sitios web tienen fallos de l√≥gica que permiten a los atacantes explotar estas p√°ginas para ver datos pertenecientes a otros usuarios. Asegurar controles de acceso y validaci√≥n adecuados es crucial para prevenir el acceso no autorizado a informaci√≥n personal.
Por ejemplo:

`GET /user/personal-info?user=carlos`

## Divulgaci√≥n de c√≥digo fuente a trav√©s de archivos de respaldo

Cuando el c√≥digo fuente es accesible a trav√©s de archivos de respaldo, facilita a los atacantes entender el comportamiento de la aplicaci√≥n y lanzar ataques graves. A veces, datos sensibles como claves API y credenciales est√°n codificados dentro del c√≥digo fuente, aumentando el riesgo. Para prevenir esto, aseg√∫rate de que los archivos de respaldo no sean accesibles p√∫blicamente.

### Laboratorio 3 - Divulgaci√≥n de c√≥digo fuente a trav√©s de archivos de respaldo

> Este laboratorio filtra su c√≥digo fuente a trav√©s de archivos de respaldo en un directorio oculto. Para resolver el laboratorio, identifica y env√≠a la contrase√±a de la base de datos, que est√° codificada en el c√≥digo fuente filtrado.

![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l3/1.png)
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l3/2.png)

## Divulgaci√≥n de informaci√≥n debido a una configuraci√≥n insegura

Los sitios web pueden ser vulnerables si est√°n mal configurados. Esto ocurre a menudo con tecnolog√≠as de terceros, donde la amplia gama de opciones de configuraci√≥n puede no ser completamente comprendida por quienes las configuran. Asegurar una configuraci√≥n adecuada es esencial para prevenir la divulgaci√≥n no intencionada de informaci√≥n y proteger datos sensibles.

### Laboratorio 4 - Bypass de autenticaci√≥n a trav√©s de divulgaci√≥n de informaci√≥n

> La interfaz de administraci√≥n de este laboratorio tiene una vulnerabilidad de bypass de autenticaci√≥n, pero es impr√°ctico explotarla sin conocer un encabezado HTTP personalizado utilizado por el front-end. Para resolver el laboratorio, obt√©n el nombre del encabezado y luego √∫salo para eludir la autenticaci√≥n del laboratorio. Accede a la interfaz de administraci√≥n y elimina al usuario carlos. Puedes iniciar sesi√≥n en tu propia cuenta utilizando las siguientes credenciales: wiener:peter

Ingresa con las credenciales
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l4/1.png)

Antes de enviar la solicitud, cambia el m√©todo a Trace.

> El m√©todo HTTP TRACE est√° dise√±ado para fines de diagn√≥stico. Si est√° habilitado, el servidor web responder√° a las solicitudes que utilicen el m√©todo TRACE devolviendo en la respuesta la solicitud exacta que se recibi√≥. Este comportamiento suele ser inofensivo, pero ocasionalmente lleva a la divulgaci√≥n de informaci√≥n, como el nombre de los encabezados de autenticaci√≥n internos que pueden ser a√±adidos a las solicitudes por proxies inversos.

Y vemos cuando la solicitud llega al servidor, con un encabezado con nuestra direcci√≥n IP.
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l4/2.png)

Cambia la URL para ver si accedes al panel de administraci√≥n. Pero aparece un mensaje. "...usuarios locales..." ü§î
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l4/3.png)

Pon el encabezado y una IP local. Y vemos el panel de administraci√≥n. Elimina a Carlos.
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l4/4.png)
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l4/5.png)

### Laboratorio 5 - Divulgaci√≥n de informaci√≥n en el historial de control de versiones

> Este laboratorio divulga informaci√≥n sensible a trav√©s de su historial de control de versiones. Para resolver el laboratorio, obt√©n la contrase√±a del usuario administrador y luego inicia sesi√≥n para eliminar al usuario carlos.

Al final de la URL pon `/.git`.
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l5/1.png)

En `COMMIT_EDITMSG` vemos este mensaje.
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l5/2.png)

Abro mi Kali y descargo.
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l5/4.png)

Con el comando `git diff` veo la diferencia entre dos commits.
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l5/5.png)

Si veo el historial de commits y los comentarios, encuentro qu√© commit tiene las credenciales que busco.
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l5/6.png)

Con `git checkout` cambio a la rama que tiene las credenciales codificadas.
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l5/7.png)

![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l5/8.png)

Finalmente, elimina a Carlos.
![](https://raw.githubusercontent.com/NicolasGula/NicolasGula/master/public/images/photos/id/l5/2024-05-10_13-46.png)

Espero que te resulte √∫til.üë®‚Äçüíª
Si tienes otro tipo de soluci√≥n o si estoy equivocado en algo, por favor h√°zmelo saber.
